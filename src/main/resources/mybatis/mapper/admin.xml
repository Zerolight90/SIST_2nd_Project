<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="admin">
    <!--모든 관리자를 구하는 쿼리 (종민)-->
    <select id="getAllAdmin" resultType="mybatis.vo.AdminVO">
        select * from admin
    </select>

    <select id="salesByTheater" resultType="mybatis.vo.RevenueVO">
        SELECT
        t.tName AS theaterName,
        SUM(p.paymentFinal) AS totalSales
        FROM
        payment p
        JOIN
        reservation r ON p.reservIdx = r.reservIdx
        JOIN
        theater t ON r.tIdx = t.tIdx
        WHERE
        p.paymentStatus = 0 -- 0:결제완료, 1:취소
        GROUP BY
        t.tName
        ORDER BY
        totalSales DESC
    </select>
</mapper>